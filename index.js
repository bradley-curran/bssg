#!/usr/bin/env node
"use strict";var x=Object.create;var u=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var L=Object.getOwnPropertyNames;var q=Object.getPrototypeOf,v=Object.prototype.hasOwnProperty;var M=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of L(e))!v.call(t,s)&&s!==r&&u(t,s,{get:()=>e[s],enumerable:!(o=O(e,s))||o.enumerable});return t};var N=(t,e,r)=>(r=t!=null?x(q(t)):{},M(e||!t||!t.__esModule?u(r,"default",{value:t,enumerable:!0}):r,t));var h=require("fs/promises"),k=N(require("./node_modules/toml/index.js"));var c=require("fs/promises"),R=t=>`cp (${t.inputFile} -> ${t.outputFile})`,B=async t=>(0,c.cp)(t.inputFile,t.outputFile),l={description:R,step:B};var a=require("fs/promises"),E=t=>`mkdir (${t.path})`,J=async t=>(0,a.mkdir)(t.path),m={description:E,step:J};var d=require("fs/promises"),T=t=>`rm (${t.path})`,K=async t=>(0,d.rm)(t.path,{recursive:!0,force:!0}),g={description:T,step:K};var _=t=>`steplist (${t.steps})`,j=async(t,e)=>{for(let r of t.steps)await e(r)},f={description:_,step:j};var i=require("fs/promises"),F=require("./node_modules/less/index.js"),z=t=>`lessc (${t.inputFile} -> ${t.outputFile})`,A=async t=>{let e=await(0,i.readFile)(t.inputFile),r=await(0,F.render)(e.toString());return(0,i.writeFile)(t.outputFile,r.css)},y={description:z,step:A};var n=require("fs/promises"),P=require("./node_modules/pug/lib/index.js"),D=require("./node_modules/unified/index.js"),G=require("./node_modules/remark-parse/index.js"),H=require("./node_modules/remark-rehype/index.js"),I=require("./node_modules/rehype-stringify/index.js"),Q=require("./node_modules/pretty/index.js"),U=t=>`markdownc (extends: ${t.extends}, ${t.inputFile} -> ${t.outputFile})`,V=async t=>{let e=D().use(G).use(H).use(I),r=await(0,n.readFile)(t.inputFile),s=(await e.process(r.toString())).contents,S=(0,P.compileFile)(t.extends)().replace("BLOCK_CONTENT",s),b=Q(S);return(0,n.writeFile)(t.outputFile,b)},w={description:U,step:V};var C=require("./node_modules/pug/lib/index.js"),p=require("fs/promises"),W=require("./node_modules/pretty/index.js"),X=async t=>{if(t){let e=await(0,p.readFile)(t);return JSON.parse(e.toString())}return{}},Y=t=>`pugc (localsFile: ${t.localsFile}, ${t.inputFile} -> ${t.outputFile})`,Z=async t=>{let e=await X(t.localsFile),r=(0,C.compileFile)(t.inputFile)(e),o=W(r);return(0,p.writeFile)(t.outputFile,o)},$={description:Y,step:Z};var tt={cp:l,lessc:y,markdownc:w,mkdir:m,pugc:$,rm:g,steplist:f},et=async()=>{let t=await(0,h.readFile)("bssg.toml"),e=k.parse(t.toString()),r=JSON.parse(JSON.stringify(e));if(!r.hasOwnProperty("bssg"))throw new Error("bssg.toml does not have a 'bssg' top-level key");return r},rt=async t=>{let e=async r=>{let o=t[r];if(o===void 0)throw new Error(`Could not find step '${r}'`);let s=tt[o.step];console.log(`${r}: ${s.description(o)}`),await s.step(o,e)};await e("build"),console.log("bssg build complete")};et().then(rt).catch(t=>console.log(t.message));
//# sourceMappingURL=index.js.map
