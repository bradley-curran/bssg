#!/usr/bin/env node
"use strict";var O=Object.create;var u=Object.defineProperty;var T=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,q=Object.prototype.hasOwnProperty;var v=(t,r,e,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let s of C(r))!q.call(t,s)&&s!==e&&u(t,s,{get:()=>r[s],enumerable:!(o=T(r,s))||o.enumerable});return t};var M=(t,r,e)=>(e=t!=null?O(L(t)):{},v(r||!t||!t.__esModule?u(e,"default",{value:t,enumerable:!0}):e,t));var k=require("fs/promises"),S=M(require("./node_modules/toml/index.js"));var a=require("fs/promises"),N=t=>`cp (${t.inputFile} -> ${t.outputFile})`,R=async t=>(0,a.cp)(t.inputFile,t.outputFile),c={description:N,step:R};var m=require("fs/promises"),B=t=>`mkdir (${t.path})`,E=async t=>(0,m.mkdir)(t.path),l={description:B,step:E};var f=require("fs/promises"),J=t=>`rm (${t.path})`,K=async t=>(0,f.rm)(t.path,{recursive:!0,force:!0}),d={description:J,step:K};var _=t=>`steplist (${t.steps})`,j=async(t,r)=>{for(let e of t.steps)await r(e)},g={description:_,step:j};var i=require("fs/promises"),F=require("./node_modules/less/index.js"),z=t=>`transformless (${t.inputFile} -> ${t.outputFile})`,A=async t=>{let r=await(0,i.readFile)(t.inputFile),e=await(0,F.render)(r.toString());return(0,i.writeFile)(t.outputFile,e.css)},y={description:z,step:A};var n=require("fs/promises"),P=require("./node_modules/pug/lib/index.js"),D=require("./node_modules/unified/index.js"),G=require("./node_modules/remark-parse/index.js"),H=require("./node_modules/remark-rehype/index.js"),I=require("./node_modules/rehype-stringify/index.js"),Q=require("./node_modules/pretty/index.js"),U=t=>`transformmarkdown (extends: ${t.extends}, ${t.inputFile} -> ${t.outputFile})`,V=async t=>{let r=D().use(G).use(H).use(I),e=await(0,n.readFile)(t.inputFile),s=(await r.process(e.toString())).contents,b=(0,P.compileFile)(t.extends)().replace("BLOCK_CONTENT",s),x=Q(b);return(0,n.writeFile)(t.outputFile,x)},w={description:U,step:V};var $=require("./node_modules/pug/lib/index.js"),p=require("fs/promises"),W=require("./node_modules/pretty/index.js"),X=async t=>{if(t){let r=await(0,p.readFile)(t);return JSON.parse(r.toString())}return{}},Y=t=>`transformpug (localsFile: ${t.localsFile}, ${t.inputFile} -> ${t.outputFile})`,Z=async t=>{let r=await X(t.localsFile),e=(0,$.compileFile)(t.inputFile)(r),o=W(e);return(0,p.writeFile)(t.outputFile,o)},h={description:Y,step:Z};var tt={cp:c,mkdir:l,rm:d,steplist:g,transformless:y,transformmarkdown:w,transformpug:h},rt=async()=>{let t=await(0,k.readFile)("bssg.toml"),r=S.parse(t.toString()),e=JSON.parse(JSON.stringify(r));if(!e.hasOwnProperty("bssg"))throw new Error("bssg.toml does not have a 'bssg' top-level key");return e},et=async t=>{let r=async e=>{let o=t[e];if(o===void 0)throw new Error(`Could not find step '${e}'`);let s=tt[o.step];console.log(`${e}: ${s.description(o)}`),await s.step(o,r)};await r("build"),console.log("bssg build complete")};rt().then(et).catch(t=>console.log(t.message));
//# sourceMappingURL=index.js.map
